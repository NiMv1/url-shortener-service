server:
  port: 8090

spring:
  application:
    name: url-shortener-service
  
  data:
    mongodb:
      uri: mongodb://${MONGO_HOST:localhost}:${MONGO_PORT:27017}/${MONGO_DB:url_shortener}
      auto-index-creation: true
    
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD:}
      timeout: 2000ms
  
  rabbitmq:
    host: ${RABBITMQ_HOST:localhost}
    port: ${RABBITMQ_PORT:5672}
    username: ${RABBITMQ_USERNAME:guest}
    password: ${RABBITMQ_PASSWORD:guest}

# JWT конфигурация
jwt:
  secret: ${JWT_SECRET:urlShortenerSecretKeyForJWTTokenGenerationThatIsAtLeast256BitsLong}
  access-token-expiration: 3600000  # 1 час

# Конфигурация сокращения ссылок
url-shortener:
  base-url: ${BASE_URL:http://localhost:8090}
  short-code-length: 7
  default-expiration-days: 30
  max-custom-alias-length: 20

# Rate Limiting
rate-limiter:
  requests-per-second: 10
  burst-capacity: 20

# Actuator
management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus,metrics
  endpoint:
    health:
      show-details: always
  metrics:
    tags:
      application: ${spring.application.name}

# OpenAPI
springdoc:
  api-docs:
    path: /api-docs
  swagger-ui:
    path: /swagger-ui.html

# Логирование
logging:
  level:
    root: INFO
    com.urlshortener: DEBUG
    org.springframework.data.mongodb: DEBUG

# RabbitMQ очереди
rabbitmq:
  queues:
    analytics: url-analytics-queue
    notifications: url-notifications-queue
  exchanges:
    analytics: url-analytics-exchange
  routing-keys:
    click: url.click
    created: url.created

# Resilience4j
resilience4j:
  ratelimiter:
    instances:
      default:
        limitForPeriod: 100
        limitRefreshPeriod: 1s
        timeoutDuration: 0
      createUrl:
        limitForPeriod: 10
        limitRefreshPeriod: 1s
        timeoutDuration: 500ms
